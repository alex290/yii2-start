<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        
<link href="./assets/1728b664/css/bootstrap.css" rel="stylesheet">
<link href="./assets/9c5d0894/solarized_light.css" rel="stylesheet">
<link href="./assets/f2ce5bcd/style.css" rel="stylesheet">
<script src="./assets/bbf84a7a/jquery.js"></script>
<script src="./assets/1728b664/js/bootstrap.js"></script>
<script src="./assets/fd63b446/jssearch.js"></script>    <title>Оптимизация производительности - Специальные темы - The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w1213" class="navbar-inverse navbar-fixed-top navbar"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w1213-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">The Definitive Guide to Yii 2.0</a></div><div id="w1213-collapse" class="collapse navbar-collapse"><ul id="w1214" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Extensions <span class="caret"></span></a><ul id="w1215" class="dropdown-menu"><li><a href="./ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="./ext-authclient-index.html" tabindex="-1">authclient</a></li>
<li><a href="./ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="./ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="./ext-elasticsearch-index.html" tabindex="-1">elasticsearch</a></li>
<li><a href="./ext-faker-index.html" tabindex="-1">faker</a></li>
<li><a href="./ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="./ext-httpclient-index.html" tabindex="-1">httpclient</a></li>
<li><a href="./ext-imagine-index.html" tabindex="-1">imagine</a></li>
<li><a href="./ext-jui-index.html" tabindex="-1">jui</a></li>
<li><a href="./ext-mongodb-index.html" tabindex="-1">mongodb</a></li>
<li><a href="./ext-redis-index.html" tabindex="-1">redis</a></li>
<li><a href="./ext-shell-index.html" tabindex="-1">shell</a></li>
<li><a href="./ext-smarty-index.html" tabindex="-1">smarty</a></li>
<li><a href="./ext-sphinx-index.html" tabindex="-1">sphinx</a></li>
<li><a href="./ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li>
<li><a href="./ext-twig-index.html" tabindex="-1">twig</a></li></ul></li>
<li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-1197" data-toggle="collapse" data-parent="#navigation">Введение <b class="caret"></b></a><div id="navigation-1197" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">О Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">Обновление с версии 1.1</a></div>
<a class="list-group-item" href="#navigation-1198" data-toggle="collapse" data-parent="#navigation">Первое знакомство <b class="caret"></b></a><div id="navigation-1198" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">Установка Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">Запуск приложения</a>
<a class="list-group-item" href="./guide-start-hello.html">Говорим «привет»</a>
<a class="list-group-item" href="./guide-start-forms.html">Работа с формами</a>
<a class="list-group-item" href="./guide-start-databases.html">Работа с базами данных</a>
<a class="list-group-item" href="./guide-start-gii.html">Генерация кода при помощи Gii</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">Что дальше?</a></div>
<a class="list-group-item" href="#navigation-1199" data-toggle="collapse" data-parent="#navigation">Структура приложения <b class="caret"></b></a><div id="navigation-1199" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-structure-overview.html">Обзор</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">Входные скрипты</a>
<a class="list-group-item" href="./guide-structure-applications.html">Приложения</a>
<a class="list-group-item" href="./guide-structure-application-components.html">Компоненты приложения</a>
<a class="list-group-item" href="./guide-structure-controllers.html">Контроллеры</a>
<a class="list-group-item" href="./guide-structure-models.html">Модели</a>
<a class="list-group-item" href="./guide-structure-views.html">Представления</a>
<a class="list-group-item" href="./guide-structure-modules.html">Модули</a>
<a class="list-group-item" href="./guide-structure-filters.html">Фильтры</a>
<a class="list-group-item" href="./guide-structure-widgets.html">Виджеты</a>
<a class="list-group-item" href="./guide-structure-assets.html">Ресурсы</a>
<a class="list-group-item" href="./guide-structure-extensions.html">Расширения</a></div>
<a class="list-group-item" href="#navigation-1200" data-toggle="collapse" data-parent="#navigation">Обработка запросов <b class="caret"></b></a><div id="navigation-1200" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">Обзор</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">Bootstrapping</a>
<a class="list-group-item" href="./guide-runtime-routing.html">Разбор и генерация URL</a>
<a class="list-group-item" href="./guide-runtime-requests.html">Запросы</a>
<a class="list-group-item" href="./guide-runtime-responses.html">Ответы</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Сессии и куки</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">Обработка ошибок</a>
<a class="list-group-item" href="./guide-runtime-logging.html">Логирование</a></div>
<a class="list-group-item" href="#navigation-1201" data-toggle="collapse" data-parent="#navigation">Основные понятия <b class="caret"></b></a><div id="navigation-1201" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-concept-components.html">Компоненты</a>
<a class="list-group-item" href="./guide-concept-properties.html">Свойства</a>
<a class="list-group-item" href="./guide-concept-events.html">События</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">Поведения</a>
<a class="list-group-item" href="./guide-concept-configurations.html">Конфигурации</a>
<a class="list-group-item" href="./guide-concept-aliases.html">Псевдонимы</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">Автозагрузка классов</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">Service Locator</a>
<a class="list-group-item" href="./guide-concept-di-container.html">Dependency Injection Container</a></div>
<a class="list-group-item" href="#navigation-1202" data-toggle="collapse" data-parent="#navigation">Работа с базами данных <b class="caret"></b></a><div id="navigation-1202" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">Объекты доступа к данным (DAO)</a>
<a class="list-group-item" href="./guide-db-query-builder.html">Построитель запросов</a>
<a class="list-group-item" href="./guide-db-active-record.html">Active Record</a>
<a class="list-group-item" href="./guide-db-migrations.html">Миграции</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-sphinx/blob/master/docs/guide-ru/README.md">Sphinx</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-redis/blob/master/docs/guide-ru/README.md">Redis</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-mongodb/blob/master/docs/guide-ru/README.md">MongoDB</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-elasticsearch/blob/master/docs/guide-ru/README.md">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-1203" data-toggle="collapse" data-parent="#navigation">Получение данных от пользователя <b class="caret"></b></a><div id="navigation-1203" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">Создание форм</a>
<a class="list-group-item" href="./guide-input-validation.html">Валидация</a>
<a class="list-group-item" href="./guide-input-file-upload.html">Загрузка файлов</a>
<a class="list-group-item" href="./guide-input-tabular-input.html">Табличный ввод</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">Работа с несколькими моделями</a>
<a class="list-group-item" href="./guide-input-form-javascript.html">Расширение ActiveForm на стороне клиента</a></div>
<a class="list-group-item" href="#navigation-1204" data-toggle="collapse" data-parent="#navigation">Отображение данных <b class="caret"></b></a><div id="navigation-1204" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatting.html">Форматирование данных</a>
<a class="list-group-item" href="./guide-output-pagination.html">Постраничная разбивка</a>
<a class="list-group-item" href="./guide-output-sorting.html">Сортировка</a>
<a class="list-group-item" href="./guide-output-data-providers.html">Провайдеры данных</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">Виджеты для данных</a>
<a class="list-group-item" href="./guide-output-client-scripts.html">Работа с клиентскими скриптами</a>
<a class="list-group-item" href="./guide-output-theming.html">Темизация</a></div>
<a class="list-group-item" href="#navigation-1205" data-toggle="collapse" data-parent="#navigation">Безопасность <b class="caret"></b></a><div id="navigation-1205" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-overview.html">Обзор</a>
<a class="list-group-item" href="./guide-security-authentication.html">Аутентификация</a>
<a class="list-group-item" href="./guide-security-authorization.html">Авторизация</a>
<a class="list-group-item" href="./guide-security-passwords.html">Работа с паролями</a>
<a class="list-group-item" href="./guide-security-cryptography.html">Криптография</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-authclient/blob/master/docs/guide-ru/README.md">Клиенты авторизации</a>
<a class="list-group-item" href="./guide-security-best-practices.html">Лучшие практики</a></div>
<a class="list-group-item" href="#navigation-1206" data-toggle="collapse" data-parent="#navigation">Кеширование <b class="caret"></b></a><div id="navigation-1206" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">Обзор</a>
<a class="list-group-item" href="./guide-caching-data.html">Кэширование данных</a>
<a class="list-group-item" href="./guide-caching-fragment.html">Кэширование фрагментов</a>
<a class="list-group-item" href="./guide-caching-page.html">Кэширование страниц</a>
<a class="list-group-item" href="./guide-caching-http.html">HTTP кэширование</a></div>
<a class="list-group-item" href="#navigation-1207" data-toggle="collapse" data-parent="#navigation">Веб-сервисы REST <b class="caret"></b></a><div id="navigation-1207" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">Быстрый старт</a>
<a class="list-group-item" href="./guide-rest-resources.html">Ресурсы</a>
<a class="list-group-item" href="./guide-rest-controllers.html">Контроллеры</a>
<a class="list-group-item" href="./guide-rest-routing.html">Роутинг</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">Форматирование ответа</a>
<a class="list-group-item" href="./guide-rest-authentication.html">Аутентификация</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">Ограничение частоты запросов</a>
<a class="list-group-item" href="./guide-rest-versioning.html">Версионирование</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">Обработка ошибок</a></div>
<a class="list-group-item" href="#navigation-1208" data-toggle="collapse" data-parent="#navigation">Инструменты разработчика <b class="caret"></b></a><div id="navigation-1208" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide/README.md">Отладочная панель и отладчик</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-gii/blob/master/docs/guide/README.md">Генерация кода с Gii</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-apidoc">Генератор документации API</a></div>
<a class="list-group-item" href="#navigation-1209" data-toggle="collapse" data-parent="#navigation">Тестирование <b class="caret"></b></a><div id="navigation-1209" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">Обзор</a>
<a class="list-group-item" href="./guide-test-environment-setup.html">Настройка тестового окружения</a>
<a class="list-group-item" href="./guide-test-unit.html">Модульные тесты</a>
<a class="list-group-item" href="./guide-test-functional.html">Функциональные тесты</a>
<a class="list-group-item" href="./guide-test-acceptance.html">Приёмочные тесты</a>
<a class="list-group-item" href="./guide-test-fixtures.html">Фикстуры</a></div>
<a class="list-group-item active" href="#navigation-1210" data-toggle="collapse" data-parent="#navigation">Специальные темы <b class="caret"></b></a><div id="navigation-1210" class="submenu panel-collapse collapse in"><a class="list-group-item" href="https://github.com/yiisoft/yii2-app-advanced/blob/master/docs/guide/README.md">Шаблон приложения advanced</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">Создание приложения с нуля</a>
<a class="list-group-item" href="./guide-tutorial-console.html">Консольные команды</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">Встроенные валидаторы</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">Интернационализация</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">Отправка почты</a>
<a class="list-group-item active" href="./guide-tutorial-performance-tuning.html">Оптимизация производительности</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">Окружение виртуального хостинга</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">Шаблонизаторы</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">Работа со сторонним кодом</a>
<a class="list-group-item" href="./guide-tutorial-yii-as-micro-framework.html">Использование Yii в качестве микро-framework&#039;а</a></div>
<a class="list-group-item" href="#navigation-1211" data-toggle="collapse" data-parent="#navigation">Виджеты <b class="caret"></b></a><div id="navigation-1211" class="submenu panel-collapse collapse"><a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-grid-gridview.html">GridView</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-listview.html">ListView</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-detailview.html">DetailView</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/guide-input-forms.html#activerecord-based-forms-activeform">ActiveForm</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-pjax.html">Pjax</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-menu.html">Menu</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-linkpager.html">LinkPager</a>
<a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/yii-widgets-linksorter.html">LinkSorter</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-bootstrap/blob/master/docs/guide-ru/README.md">Виджеты Bootstrap</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-jui/blob/master/docs/guide-ru/README.md">Виджеты Jquery UI</a></div>
<a class="list-group-item" href="#navigation-1212" data-toggle="collapse" data-parent="#navigation">Хелперы <b class="caret"></b></a><div id="navigation-1212" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">Обзор</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url хелпер</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Оптимизация производительности <span id="optimizacia-proizvoditelnosti"></span><a href="#optimizacia-proizvoditelnosti" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#optimizing-php">Оптимизация окружения PHP</a></li>
<li><a href="#disable-debug">Отключение режима отладки</a></li>
<li><a href="#using-caching">Использование техник кеширования</a></li>
<li><a href="#enable-schema-caching">Включение кеширования схемы</a></li>
<li><a href="#optimizing-assets">Объединение и минимизация ресурсов</a></li>
<li><a href="#optimizing-session">Оптимизация хранилища сессий</a></li>
<li><a href="#optimizing-databases">Оптимизация базы данных</a></li>
<li><a href="#using-arrays">Использование обычных массивов</a></li>
<li><a href="#optimizing-autoloader">Оптимизация автозагрузчика Composer</a></li>
<li><a href="#processing-data-offline">Асинхронная обработка данных</a></li>
<li><a href="#performance-profiling">Профилирование производительности</a></li></ol></div>
<p>Существует много факторов, влияющих на производительность веб-приложения. Какие-то относятся к окружению, какие-то 
к вашему коду, а какие-то к самому Yii. В этом разделе мы перечислим большинство из них и объясним, как можно улучшить 
производительность приложения, регулируя эти факторы.</p>
<h2>Оптимизация окружения PHP  <span id="optimizing-php"></span><a href="#optimizing-php" class="hashlink">&para;</a></h2><p>Хорошо сконфигурированное окружение PHP очень важно. Для получения максимальной производительности,</p>
<ul>
<li>Используйте последнюю стабильную версию PHP. Мажорные релизы PHP могут принести значительные улучшения производительности.</li>
<li>Включите кеширование байткода в <a href="https://secure.php.net/manual/ru/book.opcache.php">Opcache</a> (PHP 5.5 и старше) или <a href="http://secure.php.net/manual/ru/book.apc.php">APC</a> 
(PHP 5.4 и более ранние версии). Кеширование байткода позволяет избежать затрат времени на обработку и подключение PHP 
скриптов при каждом входящем запросе.</li>
</ul>
<h2>Отключение режима отладки  <span id="disable-debug"></span><a href="#disable-debug" class="hashlink">&para;</a></h2><p>При запуске приложения в производственном режиме, вам нужно отключить режим отладки. Yii использует значение константы
<code>YII_DEBUG</code> чтобы указать, следует ли включить режим отладки. Когда режим отладки включен, Yii тратит дополнительное 
время, чтобы создать и записать отладочную информацию.</p>
<p>Вы можете разместить следующую строку кода в начале <a href="guide-structure-entry-scripts.html">входного скрипта</a> чтобы 
отключить режим отладки:</p>
<pre><code class="hljs php language-php">defined(<span class="hljs-string">'YII_DEBUG'</span>) <span class="hljs-keyword">or</span> define(<span class="hljs-string">'YII_DEBUG'</span>, <span class="hljs-keyword">false</span>);
</code></pre>
<blockquote class="info"><p><strong>Информация: </strong>Значение по умолчанию для константы <code>YII_DEBUG</code> — <code>false</code>. 
Так что, если вы уверены, что не изменяете значение по умолчанию где-то в коде приложения, можете просто удалить эту 
строку, чтобы отключить режим отладки.</p>
</blockquote>
<h2>Использование техник кеширования  <span id="using-caching"></span><a href="#using-caching" class="hashlink">&para;</a></h2><p>Вы можете использовать различные техники кеширования чтобы значительно улучшить производительность вашего приложения. 
Например, если ваше приложение позволяет пользователям вводить текст в формате Markdown, вы можете закешировать 
разобранное содержимого Markdown, чтобы избежать разбора одной и той же разметки Markdown неоднократно 
при каждом запросе. Пожалуйста, обратитесь к разделу <a href="guide-caching-overview.html">Кеширование</a> чтобы узнать о поддержке 
кеширования, которую предоставляет Yii.</p>
<h2>Включение кеширования схемы  <span id="enable-schema-caching"></span><a href="#enable-schema-caching" class="hashlink">&para;</a></h2><p>Кэширование схемы - это специальный <em>тип кеширования</em>, который должен быть включен при использовании <a href="guide-db-active-record.html">Active Record</a>.
Как вы знаете, Active Record достаточно умен, чтобы обнаружить информацию о схеме (например, имена столбцов, типы столбцов, 
ограничения) таблицы БД без необходимости описывать ее вручную. Active Record получает эту информацию, выполняя 
дополнительные SQL запросы. При включении кэширования схемы, полученная информация о схеме будет сохранена в кэше и 
повторно использована при последующих запросах.</p>
<p>Чтобы включить кеширование схемы, сконфигурируйте <a href="guide-structure-application-components.html">компонент приложения</a> <code>cache</code> 
для хранения информации о схеме и установите <a href="./yii-db-connection.html#$enableSchemaCache-detail">yii\db\Connection::$enableSchemaCache</a> в <code>true</code> в <a href="guide-concept-configurations.html">конфигурации приложения</a>:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-comment">// ...</span>
        <span class="hljs-string">'cache'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\caching\FileCache'</span>,
        ],
        <span class="hljs-string">'db'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\db\Connection'</span>,
            <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'mysql:host=localhost;dbname=mydatabase'</span>,
            <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
            <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
            <span class="hljs-string">'enableSchemaCache'</span> =&gt; <span class="hljs-keyword">true</span>,

            <span class="hljs-comment">// Продолжительность кеширования схемы.</span>
            <span class="hljs-string">'schemaCacheDuration'</span> =&gt; <span class="hljs-number">3600</span>,

            <span class="hljs-comment">// Название компонента кеша, используемого для хранения информации о схеме</span>
            <span class="hljs-string">'schemaCache'</span> =&gt; <span class="hljs-string">'cache'</span>,
        ],
    ],
];
</code></pre>
<h2>Объединение и минимизация ресурсов  <span id="optimizing-assets"></span><a href="#optimizing-assets" class="hashlink">&para;</a></h2><p>Сложные веб-страницы часто подключают много CSS и/или JavaScript файлов. Для уменьшения числа HTTP запросов
и общего размера загрузки этих ресурсов, вы должны рассмотреть вопрос об их объединении в один файл и его сжатии.
Это может сильно увеличить скорость загрузки страницы и снизить нагрузку на сервер. Для получения более подробной
информации обратитесь, пожалуйста, к разделу <a href="guide-structure-assets.html">Ресурсы</a></p>
<h2>Оптимизация хранилища сессий  <span id="optimizing-session"></span><a href="#optimizing-session" class="hashlink">&para;</a></h2><p>По умолчанию данные сессий хранятся в файлах. Это удобно для разработки или в маленьких проектах.
Но когда дело доходит до обработки множества параллельных запросов, то лучше использовать более сложные хранилища, 
такие как базы данных. Yii поддерживает различные хранилища "из коробки". 
Вы можете использовать эти хранилища, сконфигурировав компонент <code>session</code> в
<a href="guide-concept-configurations.html">конфигурации приложения</a> как показано ниже,</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-string">'session'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\web\DbSession'</span>,

            <span class="hljs-comment">// Установите следующее, если вы хотите использовать компонент БД, с названием</span>
            <span class="hljs-comment">// отличным от значения по умолчанию 'db'.</span>
            <span class="hljs-comment">// 'db' =&gt; 'mydb',</span>

            <span class="hljs-comment">// Чтобы перезаписать таблицу сессий, заданную по умолчанию, установите</span>
            <span class="hljs-comment">// 'sessionTable' =&gt; 'my_session',</span>
        ],
    ],
];
</code></pre>
<p>Приведенная выше конфигурация использует таблицу базы данных для хранения сессионных данных. По умолчанию, используется 
компонент приложения <code>db</code> для подключения к базе данных и сохранения сессионных данных в таблице <code>session</code>. Вам нужно будет 
создать таблицу <code>session</code> заранее:</p>
<pre><code class="hljs sql language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">session</span> (
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">40</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> PRIMARY <span class="hljs-keyword">KEY</span>,
    <span class="hljs-keyword">expire</span> <span class="hljs-built_in">INTEGER</span>,
    <span class="hljs-keyword">data</span> <span class="hljs-built_in">BLOB</span>
)
</code></pre>
<p>Вы также можете хранить сессионные данные в кеше с помощью <a href="./yii-web-cachesession.html">yii\web\CacheSession</a>. Теоретически, вы можете использовать 
любое поддерживаемое <a href="guide-caching-data.html#supported-cache-storage">хранилище кеша</a>. Тем не менее, помните, что некоторые 
хранилища кеша могут <em>сбрасывать</em> закешированные данные при достижении лимитов хранилища. По этой причине, вы должны в 
основном использовать хранилища кеша, которые не имеют таких лимитов.</p>
<p>Если на вашем сервере установлен <a href="http://redis.io/">Redis</a>, настоятельно рекомендуется выбрать его в качестве 
хранилища сессий используя <a href="./yii-redis-session.html">yii\redis\Session</a>.</p>
<h2>Оптимизация базы данных  <span id="optimizing-databases"></span><a href="#optimizing-databases" class="hashlink">&para;</a></h2><p>Выполнение запросов к БД и выборки данных часто являются узким местом производительности веб-приложения. 
Хотя использование техник <a href="guide-caching-data.html">кэширования данных</a> может <em>смягчить</em> снижение производительности, оно не 
решает проблему полностью. Когда база данных содержит огромное количество данных, и данные в кэше невалидны, получение 
свежих данных без правильного проектирования БД и запросов может быть чрезмерно ресурсоемкой операцией.</p>
<p>Общей методикой для повышения производительности запросов к БД является создание индексов для тех столбцов таблицы, по которым делается выборка.
Например, если вам нужно найти запись о пользователе по <code>username</code>, вам надо создать индекс на <code>username</code>. 
Обратите внимание, что в то время как индексирование может сделать SELECT запросы намного быстрее, оно будет замедлять INSERT, UPDATE и DELETE запросы.</p>
<p>Для сложных запросов к БД рекомендуется создавать представления базы данных (views), чтобы сэкономить время подготовки и разбора запросов.</p>
<p>Последнее, хотя и не менее важное: используйте <code>LIMIT</code> в ваших <code>SELECT</code> запросах. Это позволяет избежать извлечения 
большого количество данных из базы данных и исчерпания памяти, выделенной для PHP.</p>
<h2>Использование обычных массивов  <span id="using-arrays"></span><a href="#using-arrays" class="hashlink">&para;</a></h2><p>Хотя <a href="guide-db-active-record.html">Active Record</a> очень удобно использовать, это не так эффективно, как использование простых 
массивов, когда вам нужно получить большое количество данных из БД. В этом случае вы можете вызвать <code>asArray()</code> при 
использовании Active Record для получения данных, чтобы извлеченные данные были представлены в виде массивов вместо 
громоздких записей Active Record. Например,</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionIndex</span><span class="hljs-params">()</span>
    </span>{
        $posts = Post::find()-&gt;limit(<span class="hljs-number">100</span>)-&gt;asArray()-&gt;all();
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;render(<span class="hljs-string">'index'</span>, [<span class="hljs-string">'posts'</span> =&gt; $posts]);
    }
}
</code></pre>
<p>В приведенном выше коде, <code>$posts</code> будет заполнего массивом строк из таблицы. Каждая строка - это обычный массив. Чтобы 
получить доступ к столбцу <code>title</code> в i-й строке, вы можете использовать выражение <code>$posts[$i]['title']</code>.</p>
<p>Вы также можете использовать <a href="guide-db-dao.html">DAO</a> для создания запросов и извлечения данных в виде обычных массивов. </p>
<h2>Оптимизация автозагрузчика Composer  <span id="optimizing-autoloader"></span><a href="#optimizing-autoloader" class="hashlink">&para;</a></h2><p>Поскольку автозагрузчик Composer'а используется для подключения большого количества файлов сторонних классов, вы должны 
оптимизировать его, выполнив следующую команду:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">composer</span> dumpautoload -o
</code></pre>
<h2>Асинхронная обработка данных  <span id="processing-data-offline"></span><a href="#processing-data-offline" class="hashlink">&para;</a></h2><p>Когда запрос включает в себя некоторые ресурсоёмкие операции, вы должны подумать о том, чтобы выполнить эти операции 
асинхронно, не заставляя пользователя ожидать их окончания.</p>
<p>Существует два метода асинхронной обработки данных: pull и push. </p>
<p>В методе pull, всякий раз, когда запрос включает в себя некоторые сложные операции, вы создаете задачу и сохраняете ее в 
постоянном хранилище, таком как база данных. Затем в отдельном процессе (таком как задание cron) получаете эту задачу и 
обрабатываете ее.</p>
<p>Этот метод легко реализовать, но у него есть некоторые недостатки. Например, задачи надо периодически забирать из 
места их хранения. Если делать это слишком редко, задачи будут обрабатываться с большой задержкой, а если слишком часто - 
это будет создавать большие накладные расходы.</p>
<p>В методе push, вы можете использовать очереди сообщений (например, RabbitMQ, ActiveMQ, Amazon SQS, и т.д.) для управления задачами.
Всякий раз, когда новая задача попадает в очередь, это инициирует обработку этой задачи обработчиком.</p>
<h2>Профилирование производительности  <span id="performance-profiling"></span><a href="#performance-profiling" class="hashlink">&para;</a></h2><p>Вы должны профилировать код, чтобы определить узкие места в производительности и принять соответствующие меры.
Следующие инструменты для профилирования могут оказаться полезными:</p>
<ul>
<li><a href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide/README.md">Отладочный тулбар Yii и отладчик</a></li>
<li><a href="http://xdebug.org/docs/profiler">Профайлер XDebug</a></li>
<li><a href="https://secure.php.net/manual/en/book.xhprof.php">XHProf</a></li>
</ul>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Wed, 09 Dec 2020 00:16:07 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script>jQuery(function ($) {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
